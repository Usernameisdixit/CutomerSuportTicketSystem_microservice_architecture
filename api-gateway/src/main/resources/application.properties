spring.application.name=api-gateway
server.port=8083

logging.level.org.springframework.cloud.gateway=DEBUG
logging.level.reactor.netty=INFO
spring.config.import=optional:classpath:application-secret.properties

# ========================
# user-service (JWT protected)
# ========================
spring.cloud.gateway.server.webflux.routes[0].id=user-service
spring.cloud.gateway.server.webflux.routes[0].uri=http://localhost:8081
spring.cloud.gateway.server.webflux.routes[0].predicates[0]=Path=/api/users/**
spring.cloud.gateway.server.webflux.routes[0].predicates[1]=Path=/api/auth/**
spring.cloud.gateway.server.webflux.routes[0].predicates[2]=Path=/swagger-ui/**
spring.cloud.gateway.server.webflux.routes[0].predicates[3]=Path=/swagger-ui.html
spring.cloud.gateway.server.webflux.routes[0].predicates[4]=Path=/webjars/swagger-ui/**

# Proxy user-service OpenAPI docs for aggregation with exact path mapping
spring.cloud.gateway.server.webflux.routes[2].id=user-service-api-docs
spring.cloud.gateway.server.webflux.routes[2].uri=http://localhost:8081
spring.cloud.gateway.server.webflux.routes[2].predicates[0]=Path=/v3/api-docs/user-service/**
spring.cloud.gateway.server.webflux.routes[2].filters[0]=RewritePath=/v3/api-docs/user-service/(?<segment>.*),/v3/api-docs/${segment}

# ========================
# ticket-service (JWT protected)
# ========================
spring.cloud.gateway.server.webflux.routes[1].id=ticket-service
spring.cloud.gateway.server.webflux.routes[1].uri=http://localhost:8082
spring.cloud.gateway.server.webflux.routes[1].predicates[0]=Path=/api/tickets/**

# Proxy ticket-service OpenAPI docs for aggregation
spring.cloud.gateway.server.webflux.routes[3].id=ticket-service-api-docs
spring.cloud.gateway.server.webflux.routes[3].uri=http://localhost:8082
spring.cloud.gateway.server.webflux.routes[3].predicates[0]=Path=/v3/api-docs/ticket-service/**
spring.cloud.gateway.server.webflux.routes[3].filters[0]=RewritePath=/v3/api-docs/ticket-service/(?<segment>.*),/v3/api-docs/${segment}

# Proxy ticket-service Swagger UI static resources if needed
spring.cloud.gateway.server.webflux.routes[4].id=ticket-service-swagger-assets
spring.cloud.gateway.server.webflux.routes[4].uri=http://localhost:8082
spring.cloud.gateway.server.webflux.routes[4].predicates[0]=Path=/webjars/swagger-ui/**
